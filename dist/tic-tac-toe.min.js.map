{"version":3,"sources":["tic-tac-toe.min.js"],"names":["angular","module","TicTacToeService","$q","this","getAvailableMoves","cells","availableMoves","i","push","getWinner","resolve","then","makeMove","value","difficulty","makeHardMove","tree","move","parent","points","expandTree","getChildren","node","numberOfAvailableMoves","length","getOtherValue","tempCells","copy","winner","children","treeLength","j","childrenLength","k","childNode","makeEasyMove","random","Math","round","reset","service","$inject","TicTacToeController","beginOpponentsTurn","opponenentValue","cell","switchTurn","beginUsersTurn","showMessage","select","isGameOver","isUsersTurn","userValue","setOrder","floor","fromUser","message","$","attr","popover","start","stats","init","controller","directive","controllerAs","restrict","scope","template"],"mappings":"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","file":"tic-tac-toe.min.js","sourcesContent":["(function() {\n    'use strict';\n\n    angular.module('ticTacToe', []);\n})();\n(function() {\n    'use strict';\n\n    angular.module('ticTacToe').service(\n        'TicTacToeService',\n        TicTacToeService\n    );\n\n    TicTacToeService.$inject = [\n        '$q'\n    ];\n\n    function TicTacToeService(\n        $q\n    ) {\n        var TicTacToeService = this;\n\n        TicTacToeService.getAvailableMoves = getAvailableMoves;\n        function getAvailableMoves(cells) {\n            var availableMoves = [];\n\n            for (var i = 0; i < 9; i++) {\n                if (cells[i] === -1) {\n                    availableMoves.push(i);\n                }\n            }\n\n            return availableMoves;\n        }\n\n        TicTacToeService.getWinner = getWinner;\n        function getWinner(cells) {\n            return $q.resolve().then(\n                function() {\n                    // Horizontal\n                    if (cells[0] !== -1 && cells[0] === cells[1] && cells[1] === cells[2]) {\n                        return cells[0];\n                    } else if (cells[3] !== -1 && cells[3] === cells[4] && cells[4] === cells[5]) {\n                        return cells[3];\n                    } else if (cells[6] !== -1 && cells[6] === cells[7] && cells[7] === cells[8]) {\n                        return cells[6];\n                    }\n\n                    // Vertical\n                    if (cells[0] !== -1 && cells[0] === cells[3] && cells[3] === cells[6]) {\n                        return cells[0];\n                    } else if (cells[1] !== -1 && cells[1] === cells[4] && cells[4] === cells[7]) {\n                        return cells[1];\n                    } else if (cells[2] !== -1 && cells[2] === cells[5] && cells[5] === cells[8]) {\n                        return cells[2];\n                    }\n\n                    // Diagonal\n                    if (cells[0] !== -1 && cells[0] === cells[4] && cells[4] === cells[8]) {\n                        return cells[0];\n                    } else if (cells[2] !== -1 && cells[2] === cells[4] && cells[4] === cells[6]) {\n                        return cells[2];\n                    }\n\n                    for (var i = 0; i < 9; i++) {\n                        if (cells[i] === -1) {\n                            return null;\n                        }\n                    }\n\n                    return -1;\n                }\n            );\n        }\n        \n        TicTacToeService.makeMove = makeMove;\n        function makeMove(value, cells, difficulty) {\n            return $q.resolve().then(\n                function() {\n                    // if (typeof difficulty === 'undefined' || difficulty === 'easy') {\n                    //     return TicTacToeService.makeEasyMove(value, cells);\n                    // } else if (difficulty === 'hard') {\n                        return TicTacToeService.makeHardMove(value, cells);\n                    // }\n                }\n            );\n        }\n\n        TicTacToeService.makeHardMove = makeHardMove;\n        function makeHardMove(value, cells) {\n            var parentNode = {\n                move:   null,\n                parent: null,\n                points: null,\n                cells:  cells,\n                value:  value\n            };\n\n            var tree = [\n                parentNode\n            ];\n\n            TicTacToeService.expandTree(tree);\n        }\n\n        TicTacToeService.getChildren = getChildren;\n        function getChildren(node) {\n            var availableMoves = TicTacToeService.getAvailableMoves(node.cells);\n            var numberOfAvailableMoves = availableMoves.length;\n\n            var value = TicTacToeService.getOtherValue(node.value);\n\n            for (var i = 0; i < numberOfAvailableMoves; i++) {\n                var move = availableMoves[i];\n\n                var tempCells = angular.copy(node.cells);\n                tempCells[move] = value;\n\n                var points = 0;\n\n                var winner = TicTacToeService.getWinner(tempCells);\n                if (winner === value || winner === -1) {\n                    points = 1;\n                }\n\n                return {\n                    children: [],\n                    move:     move,\n                    parent:   node,\n                    points:   points,\n                    cells:    tempCells,\n                    value:    value\n                };\n            }\n        }\n\n        TicTacToeService.getOtherValue = getOtherValue;\n        function getOtherValue(value) {\n            return value === 1 ? 0 : 1;\n        }\n\n        TicTacToeService.expandTree = buildTree;\n        function buildTree(tree) {\n            var treeLength = tree.length;\n\n            for (var j = 0; j < treeLength; j++) {\n                var node = tree[j];\n\n                var children = node.children;\n                var childrenLength = children.length;\n\n                for (var k = 0; k < childrenLength; k++) {\n                    var childNode = node.children[k];\n\n                    childNode.children = TicTacToeService.getChildren(childNode);\n                }\n            }\n\n            return tree;\n        }\n\n        TicTacToeService.makeEasyMove = makeEasyMove;\n        function makeEasyMove(value, cells) {\n            do {\n                var random = Math.round(Math.random() * 9);\n\n                if (cells[random] === -1 && cells[random] !== value) {\n                    return random;\n                }\n            } while (true);\n        }\n\n        TicTacToeService.reset = reset;\n        function reset() {\n\n        }\n        \n        TicTacToeService.reset();\n\n        return TicTacToeService;\n    }\n})();\n(function() {\n    'use strict';\n\n    angular.module('ticTacToe').controller(\n        'TicTacToeController',\n        TicTacToeController\n    );\n\n    TicTacToeController.$inject = [\n        'TicTacToeService'\n    ];\n\n    function TicTacToeController(\n        TicTacToeService\n    ) {\n        var TicTacToeController = this;\n\n        TicTacToeController.beginOpponentsTurn = beginOpponentsTurn;\n        function beginOpponentsTurn() {\n            return TicTacToeService.makeMove(\n                TicTacToeController.opponenentValue,\n                TicTacToeController.cells\n            ).then(\n                function(cell) {\n                    if (cell !== null) {\n                        TicTacToeController.cells[cell] = TicTacToeController.opponenentValue;\n\n                        TicTacToeController.switchTurn();\n                    }\n                }\n            );\n        }\n\n        TicTacToeController.beginUsersTurn = beginUsersTurn;\n        function beginUsersTurn() {\n            TicTacToeController.showMessage(\n                false,\n                'IT IS YOUR TURN.'\n            );\n        }\n\n        TicTacToeController.select = select;\n        function select(cell) {\n            if (TicTacToeController.isGameOver) {\n                TicTacToeController.showMessage(\n                    false,\n                    'THE GAME IS ALREADY OVER.'\n                );\n            } else if (TicTacToeController.isUsersTurn) {\n                if (TicTacToeController.cells[cell] === -1) {\n                    TicTacToeController.cells[cell] = TicTacToeController.userValue;\n\n                    TicTacToeController.switchTurn();\n                } else {\n                    TicTacToeController.showMessage(\n                        false,\n                        'YOU CANNOT GO THERE!'\n                    );\n                }\n            } else {\n                TicTacToeController.showMessage(\n                    false,\n                    'SIMMER DOWN! IT\\'S MY TURN STILL!'\n                );\n            }\n        }\n\n        TicTacToeController.setOrder = setOrder;\n        function setOrder() {\n            var random = Math.floor(Math.random() * 100);\n            if (random % 2 === 0) {\n                TicTacToeController.opponenentValue = 0;\n                TicTacToeController.userValue = 1;\n                TicTacToeController.isUsersTurn = true;\n            } else {\n                TicTacToeController.opponenentValue = 1;\n                TicTacToeController.userValue = 0;\n                TicTacToeController.isUsersTurn = false;\n            }\n        }\n\n        TicTacToeController.showMessage = showMessage;\n        function showMessage(fromUser, message) {\n            var selector = fromUser ? '.user' : '.opponent';\n\n            $(selector).attr('data-content', message).popover('show');\n        }\n\n        TicTacToeController.start = start;\n        function start() {\n            TicTacToeController.setOrder();\n\n            if (TicTacToeController.isUsersTurn) {\n                TicTacToeController.beginUsersTurn();\n            } else {\n                TicTacToeController.beginOpponentsTurn();\n            }\n        }\n\n        TicTacToeController.switchTurn = switchTurn;\n        function switchTurn() {\n            TicTacToeService.getWinner(\n                TicTacToeController.cells\n            ).then(\n                function(winner) {\n                    if (winner === TicTacToeController.opponenentValue) {\n                        TicTacToeController.isGameOver = true;\n\n                        TicTacToeController.showMessage(\n                            false,\n                            'HAHA LOSER.'\n                        );\n                    } else if (winner === TicTacToeController.userValue) {\n                        TicTacToeController.isGameOver = true;\n\n                        TicTacToeController.showMessage(\n                            false,\n                            'GOOD JOB.'\n                        );\n                    } else if (winner === -1) {\n                        TicTacToeController.isGameOver = true;\n\n                        TicTacToeController.showMessage(\n                            false,\n                            'WE TIED.'\n                        );\n\n                        TicTacToeController.showMessage(\n                            true,\n                            'WE TIED.'\n                        );\n                    } else {\n                        TicTacToeController.isUsersTurn = !TicTacToeController.isUsersTurn;\n\n                        if (TicTacToeController.isUsersTurn) {\n                            TicTacToeController.beginUsersTurn();\n                        } else {\n                            TicTacToeController.beginOpponentsTurn();\n                        }\n                    }\n                }\n            );\n        }\n\n        TicTacToeController.reset = reset;\n        function reset() {\n            TicTacToeController.cells = [\n                -1, -1, -1,\n                -1, -1, -1,\n                -1, -1, -1\n            ];\n\n            TicTacToeController.isGameOver = false;\n\n            TicTacToeController.opponenentValue = 1;\n\n            TicTacToeController.stats = false;\n\n            TicTacToeController.userValue = 0;\n\n            TicTacToeController.isUsersTurn = false;\n        }\n\n        TicTacToeController.init = init;\n        function init() {\n            TicTacToeController.reset();\n            TicTacToeController.start();\n        }\n\n        TicTacToeController.init();\n    }\n})();\n(function() {\n    'use strict';\n\n    angular.module('ticTacToe').directive(\n        'ticTacToe',\n        ticTacToe\n    );\n\n    function ticTacToe() {\n        return {\n            controller:   'TicTacToeController',\n            controllerAs: 'ctrl',\n            restrict:     'E',\n            scope:        {},\n            template:'<div class=\"global\"><div class=\"players row\"><a class=\"opponent col-6\" tabindex=\"0\" data-content data-placement=\"right\" data-toggle=\"popover\" data-trigger=\"focus\"><img src=\"img/opponent.png\"></a> <a class=\"user col-6\" tabindex=\"1\" data-content data-placement=\"left\" data-toggle=\"popover\" data-trigger=\"focus\"><img src=\"img/user.png\"></a></div><div class=\"board row\"><div data-ng-repeat=\"cell in ctrl.cells track by $index\" class=\"col-4 cell\" data-ng-class=\"{ \\'empty-cell\\': cell === -1, \\'opponent-x-cell\\': cell === 0 && ctrl.opponenentValue === 0, \\'opponent-o-cell\\': cell === 1 && ctrl.opponenentValue === 1, \\'user-x-cell\\': cell === 0 && ctrl.userValue === 0, \\'user-o-cell\\': cell === 1 && ctrl.userValue === 1 }\" data-ng-click=\"ctrl.select($index)\"></div></div></div>'\n        };\n    }\n})();"]}